<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Property Listings | DreamSpace Real Estate</title>
  <link rel="stylesheet" href="css/style.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/lightbox2/2.11.3/css/lightbox.min.css" />
  <style>
    .video-links {
      margin-top: 10px;
    }
    .video-links a {
      display: inline-block;
      margin-right: 8px;
      background: #ff6b00;
      color: white;
      padding: 6px 12px;
      border-radius: 4px;
      text-decoration: none;
    }
    .video-links a:hover {
      background: #e45d00;
    }
  </style>
</head>
<body>
  <header>
    <div class="container">
      <h1 class="logo">DreamSpace</h1>
      <nav>
        <ul>
          <li><a href="index.html">Home</a></li>
          <li><a href="listings.html" class="active">Properties</a></li>
          <li><a href="construction.html">Construction</a></li>
          <li><a href="management.html">Management</a></li>
          <li><a href="store.html">Materials Store</a></li>
          <li><a href="consulting.html">Consulting</a></li>
          <li><a href="notary.html">Notary</a></li>
          <li><a href="contact.html">Contact</a></li>
        </ul>
      </nav>
    </div>
  </header>

  <main class="container">
    <h2>Browse Properties</h2>

    <div class="filters">
      <label for="type">Type:</label>
      <select id="type">
        <option value="all">All</option>
        <option value="buy">Buy</option>
        <option value="rent">Rent</option>
        <option value="apartment">Apartment</option>
      </select>

      <label for="minPrice">Min Price:</label>
      <input type="number" id="minPrice" placeholder="0" />

      <label for="maxPrice">Max Price:</label>
      <input type="number" id="maxPrice" placeholder="1000000" />

      <button id="applyFilters">Apply Filters</button>
    </div>

    <div class="listings-container" id="listings-container">
      <p>Loading properties...</p>
    </div>
  </main>

  <footer>
    <p>© 2025 DreamSpace Real Estate. All rights reserved.</p>
  </footer>

  <!-- Firebase -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.13.1/firebase-app.js";
    import { getFirestore, collection, getDocs } from "https://www.gstatic.com/firebasejs/10.13.1/firebase-firestore.js";

    // ✅ Your Firebase Config
   const firebaseConfig = {
  apiKey: "AIzaSyAAoPIw61ZsZB8C7zH4183yWUqh44uwbgA",
  authDomain: "dreamspace-8f29c.firebaseapp.com",
  projectId: "dreamspace-8f29c",
  storageBucket: "dreamspace-8f29c.firebasestorage.app",
  messagingSenderId: "828857686522",
  appId: "1:828857686522:web:35af98d58532393029ac43",
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    const container = document.getElementById("listings-container");
    const typeFilter = document.getElementById("type");
    const minPrice = document.getElementById("minPrice");
    const maxPrice = document.getElementById("maxPrice");
    const applyFilters = document.getElementById("applyFilters");

    let properties = [];

    async function loadProperties() {
      const querySnapshot = await getDocs(collection(db, "listings"));
      properties = querySnapshot.docs.map(doc => doc.data());
      renderListings(properties);
    }

    function renderListings(data) {
      container.innerHTML = "";
      if (data.length === 0) {
        container.innerHTML = "<p>No properties found.</p>";
        return;
      }
      data.forEach(item => {
        const card = document.createElement("div");
        card.classList.add("property-card");

        let imagesHTML = "";
        if (item.images && item.images.length > 0) {
          imagesHTML = item.images.map((img, index) => `
            <a href="${img}" data-lightbox="gallery-${item.title}" data-title="${item.title}">
              <img src="${img}" alt="${item.title}" style="width:100%; max-height:200px; object-fit:cover;">
            </a>
          `).join("");
        }

        let videosHTML = "";
        if (item.videos && item.videos.length > 0) {
          videosHTML = `<div class="video-links">` +
            item.videos.map((vid, idx) => `<a href="${vid}" target="_blank">Watch Video ${idx+1}</a>`).join("") +
            `</div>`;
        }

        card.innerHTML = `
          ${imagesHTML}
          <div class="property-card-content">
            <h3>${item.title}</h3>
            <p>${item.description}</p>
            <strong>$${item.price}</strong>
            ${videosHTML}
          </div>
        `;
        container.appendChild(card);
      });
    }

    function applyFilterLogic() {
      let filtered = properties;
      const typeVal = typeFilter.value;
      const minVal = parseFloat(minPrice.value) || 0;
      const maxVal = parseFloat(maxPrice.value) || Infinity;

      if (typeVal !== "all") {
        filtered = filtered.filter(p => p.type === typeVal);
      }
      filtered = filtered.filter(p => p.price >= minVal && p.price <= maxVal);

      renderListings(filtered);
    }

    applyFilters.addEventListener("click", applyFilterLogic);

    loadProperties();
  </script>

  <!-- Lightbox -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/lightbox2/2.11.3/js/lightbox.min.js"></script>
</body>
</html>
