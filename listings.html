<body>
  <header>
    <div class="container">
      <h1 class="logo">Region</h1>
      <nav>
        <ul>
          <li><a href="index.html">Home</a></li>
          <li><a href="listings.html">Properties</a></li>
          <li><a href="construction.html">Construction</a></li>
          <li><a href="management.html">Management</a></li>
          <li><a href="store.html">Materials Store</a></li>
          <li><a href="consulting.html">Consulting</a></li>
          <li><a href="notary.html">Notary</a></li>
          <li><a href="contact.html">Contact</a></li>
        </ul>
      </nav>
    </div>
  </header>

  <main class="container">
    <h2 style="margin: 2rem 0;">Browse Properties</h2>

    <div style="margin-bottom: 2rem;">
      <label for="type">Type:</label>
      <select id="type">
        <option value="all">All</option>
        <option value="house">House</option>
        <option value="land">Land</option>
        <option value="apartment">Apartment</option>
        <option value="commercial">Commercial</option>
      </select>

      <label for="status">Status:</label>
      <select id="status">
        <option value="all">All</option>
        <option value="sale">For Sale</option>
        <option value="rent">For Rent</option>
      </select>

      <label for="minPrice">Min Price:</label>
      <input type="number" id="minPrice" placeholder="0" style="width:100px;" />

      <label for="maxPrice">Max Price:</label>
      <input type="number" id="maxPrice" placeholder="1000000" style="width:100px;" />

      <button onclick="applyFilters()">Apply Filters</button>
    </div>

    <div class="listings-container" id="listings"></div>
  </main>

  <footer>
    <p>Â© 2025 DreamSpace Real Estate. All rights reserved.</p>
  </footer>

  <!-- WhatsApp -->
  <a href="https://wa.me/+252634546066" class="whatsapp-float" target="_blank" title="Chat on WhatsApp">
    <img src="https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/whatsapp.svg" alt="WhatsApp" />
  </a>

  <!-- Firebase Scripts -->
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
  <script>
    cconst firebaseConfig = {
  apiKey: "AIzaSyAAoPIw61ZsZB8C7zH4183yWUqh44uwbgA",
  authDomain: "dreamspace-8f29c.firebaseapp.com",
  projectId: "dreamspace-8f29c",
  storageBucket: "dreamspace-8f29c.firebasestorage.app",
  messagingSenderId: "828857686522",
  appId: "1:828857686522:web:35af98d58532393029ac43",
  measurementId: "G-VQE70BBCFM"
};

    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    let allListings = [];

    const listingsContainer = document.getElementById('listings');

    function renderListings(list) {
      listingsContainer.innerHTML = '';
      if (list.length === 0) {
        listingsContainer.innerHTML = '<p>No matching listings found.</p>';
        return;
      }

      list.forEach(d => {
listingsContainer.innerHTML += `
  <div class="property-card">
    <img src="${d.image}" alt="${d.title}" />
    <div class="property-card-content">
      <h3>${d.title}</h3>
      <p>${d.desc}</p>
      <strong>$${d.price.toLocaleString()}</strong><br><br>
      <a href="property.html?id=${d.id}">View Details</a>
    </div>
  </div>
`;

      });
    }

    function applyFilters() {
      const type = document.getElementById('type').value.toLowerCase();
      const status = document.getElementById('status').value.toLowerCase();
      const minPrice = parseFloat(document.getElementById('minPrice').value) || 0;
      const maxPrice = parseFloat(document.getElementById('maxPrice').value) || 999999999;

      const filtered = allListings.filter(p => {
        return (
          (type === 'all' || p.type.toLowerCase() === type) &&
          (status === 'all' || p.status.toLowerCase() === status) &&
          p.price >= minPrice && p.price <= maxPrice
        );
      });

      renderListings(filtered);
    }

    // Load listings from Firestore
    db.collection("listings").get().then(snapshot => {
      allListings = snapshot.docs.map(doc => doc.data());
      renderListings(allListings);
    });
  </script>
</body>
