<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Admin Dashboard | DreamSpace</title>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
</head>
<body>
  <div id="login-view">
    <h2>Admin Login</h2>
    <input id="email" type="email" placeholder="Email" /><br/>
    <input id="password" type="password" placeholder="Password" /><br/>
    <button id="login-btn">Login</button>
    <p id="login-error" style="color:red;"></p>
  </div>

  <div id="admin-dashboard" style="display:none;">
    <h2>Welcome, Admin</h2>
    <button id="logout-btn">Logout</button>

    <hr>
    <h3>Manage Listings</h3>
    <button id="add-listing-btn">Add Listing</button>
    <div id="listings-control"></div>

    <hr>
    <h3>Manage Blog Posts</h3>
    <button id="add-blog-btn">Add Blog</button>
    <div id="blogs-control"></div>
  </div>

  <script>
    // 🔧 Initialize Firebase
    const firebaseConfig = {
      apiKey: "API_KEY",
      authDomain: "PROJECT_ID.firebaseapp.com",
      projectId: "PROJECT_ID",
      // ... the rest from your project
    };
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.firestore();

    // 🔐 Login
    document.getElementById('login-btn').onclick = () => {
      const email = document.getElementById('email').value;
      const password = document.getElementById('password').value;
      auth.signInWithEmailAndPassword(email, password)
        .then(() => {
          document.getElementById('login-view').style.display = 'none';
          document.getElementById('admin-dashboard').style.display = 'block';
          loadAdminData();
        })
        .catch(e => document.getElementById('login-error').textContent = e.message);
    };

    // 🔒 Logout
    document.getElementById('logout-btn').onclick = () => {
      auth.signOut().then(() => location.reload());
    };

    // 🧩 Load Admin Data
    function loadAdminData() {
      db.collection('listings').get().then(snapshot => {
        const lc = document.getElementById('listings-control');
        lc.innerHTML = '';
        snapshot.forEach(doc => {
          const d = doc.data();
          const div = document.createElement('div');
          div.textContent = d.title + ' ';
          const del = document.createElement('button');
          del.textContent = 'Delete';
          del.onclick = () => {
            db.collection('listings').doc(doc.id).delete().then(loadAdminData);
          };
          div.appendChild(del);
          lc.appendChild(div);
        });
      });
      db.collection('blogs').get().then(snapshot => {
        const bc = document.getElementById('blogs-control');
        bc.innerHTML = '';
        snapshot.forEach(doc => {
          const d = doc.data();
          const div = document.createElement('div');
          div.textContent = d.title + ' ';
          const del = document.createElement('button');
          del.textContent = 'Delete';
          del.onclick = () => {
            db.collection('blogs').doc(doc.id).delete().then(loadAdminData);
          };
          div.appendChild(del);
          bc.appendChild(div);
        });
      });
    }

    // ✅ Extend later: Add/Edit forms...
  </script>
</body>
</html>

